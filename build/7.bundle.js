(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{101:function(e,t,s){"use strict";var n=function(e,t,s,n){return new(s||(s=Promise))(function(o,a){function i(e){try{c(n.next(e))}catch(e){a(e)}}function r(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){e.done?o(e.value):new s(function(t){t(e.value)}).then(i,r)}c((n=n.apply(e,t||[])).next())})};const o="https://api.spotify.com";t.a={addTrackToPlaylist:function(e,t,s,a){return n(this,void 0,void 0,function*(){const n=encodeURI(a),i=yield fetch(`${o}/v1/playlists/${s}/tracks?uris=${n}`,{headers:{Authorization:`${e} ${t}`,"Content-Type":"application/json"},method:"POST"});if(201===i.status)return yield i.json()})},createPlaylist:function(e,t,s,a,i){return n(this,void 0,void 0,function*(){const n=yield fetch(`${o}/v1/users/${i}/playlists`,{body:JSON.stringify({collaborative:!0,description:a,name:s,public:!1}),headers:{Authorization:`${e} ${t}`,"Content-type":"application/json"},method:"POST"});if(201===n.status)return yield n.json()})},followPlaylist:function(e,t,s,a){return n(this,void 0,void 0,function*(){return 200===(yield fetch(`${o}/v1/users/${s}/playlists/${a}/followers`,{headers:{Authorization:`${e} ${t}`,"Content-Type":"application/json"},method:"PUT"})).status})},getPlaylist:function(e,t,s,a){return n(this,void 0,void 0,function*(){const n=yield fetch(`${o}/v1/users/${s}/playlists/${a}`,{headers:{Authorization:`${e} ${t}`},method:"GET"});if(200===n.status)return yield n.json()})},getPlaylistTracks:function(e,t,s,a){return n(this,void 0,void 0,function*(){const n=yield fetch(`${o}/v1/users/${s}/playlists/${a}/tracks`,{headers:{Authorization:`${e} ${t}`},method:"GET"});if(200===n.status)return yield n.json()})},getTracks:function(e,t,s){return n(this,void 0,void 0,function*(){const n=s.map(e=>e.trackID).join(","),a=yield fetch(`${o}/v1/tracks/?ids=${n}`,{headers:{Authorization:`${e} ${t}`},method:"Get"});if(200===a.status)return yield a.json()})},getUser:function(e,t){return n(this,void 0,void 0,function*(){const s=yield fetch(`${o}/v1/me`,{headers:{Authorization:`${e} ${t}`}});if(200===s.status)return yield s.json()})},searchTrack:function(e,t,s){return n(this,void 0,void 0,function*(){const n=encodeURI(s),a=yield fetch(`${o}/v1/search?q=${n}&type=track`,{headers:{Authorization:`${e} ${t}`,accept:"application/json"},method:"GET"});if(200===a.status)return yield a.json()})}}},106:function(e,t,s){"use strict";s.d(t,"b",function(){return m}),s.d(t,"a",function(){return g}),s.d(t,"d",function(){return y}),s.d(t,"c",function(){return f});var n,o,a,i,r,c=s(35),d=s.n(c),l=s(2),h=s(36);!function(e){e.Created="CREATED",e.Updated="UPDATED",e.Deleted="DELETED"}(n||(n={})),function(e){e.ContentTypeAsc="contentType_ASC",e.ContentTypeDesc="contentType_DESC",e.CreatedAtAsc="createdAt_ASC",e.CreatedAtDesc="createdAt_DESC",e.IdAsc="id_ASC",e.IdDesc="id_DESC",e.NameAsc="name_ASC",e.NameDesc="name_DESC",e.SecretAsc="secret_ASC",e.SecretDesc="secret_DESC",e.SizeAsc="size_ASC",e.SizeDesc="size_DESC",e.UpdatedAtAsc="updatedAt_ASC",e.UpdatedAtDesc="updatedAt_DESC",e.UrlAsc="url_ASC",e.UrlDesc="url_DESC"}(o||(o={})),function(e){e.HostIdAsc="hostID_ASC",e.HostIdDesc="hostID_DESC",e.IdAsc="id_ASC",e.IdDesc="id_DESC",e.SessionIdAsc="sessionID_ASC",e.SessionIdDesc="sessionID_DESC",e.ShortCodeAsc="shortCode_ASC",e.ShortCodeDesc="shortCode_DESC"}(a||(a={})),function(e){e.IdAsc="id_ASC",e.IdDesc="id_DESC",e.TrackIdAsc="trackID_ASC",e.TrackIdDesc="trackID_DESC"}(i||(i={})),function(e){e.CreatedAtAsc="createdAt_ASC",e.CreatedAtDesc="createdAt_DESC",e.IdAsc="id_ASC",e.IdDesc="id_DESC",e.UpdatedAtAsc="updatedAt_ASC",e.UpdatedAtDesc="updatedAt_DESC"}(r||(r={}));const u=d.a`
  mutation deleteTrackFromSession($trackId: ID!, $sessionId: ID!) {
    removeFromSessionOnTracks(
      tracksesTracksId: $trackId
      sessionSessionId: $sessionId
    ) {
      tracksesTracks {
        trackID
      }
      sessionSession {
        id
      }
    }
  }
`;class m extends l.Component{render(){return l.createElement(h.b,Object.assign({mutation:u},this.props))}}d.a`
  mutation createSession(
    $sessionID: String!
    $shortCode: String!
    $hostID: String!
  ) {
    createSession(
      sessionID: $sessionID
      shortCode: $shortCode
      hostID: $hostID
    ) {
      id
      shortCode
      sessionID
      hostID
    }
  }
`;const p=d.a`
  mutation createTrack($trackID: String!, $sessionGID: ID!) {
    createTracks(trackID: $trackID, sessionId: $sessionGID) {
      id
      trackID
    }
  }
`;class g extends l.Component{render(){return l.createElement(h.b,Object.assign({mutation:p},this.props))}}const y=d.a`
  query getSession($shortCode: String!) {
    Session(shortCode: $shortCode) {
      id
      trackses {
        trackID
        id
      }
      sessionID
      hostID
    }
  }
`;class f extends l.Component{render(){return l.createElement(h.c,Object.assign({query:y},this.props))}}},139:function(e,t,s){"use strict";s.r(t);var n=s(2),o=s(37),a=s(140),i=s(124),r=s(117),c=s(113),d=s(118),l=s(31),h=s(125),u=s.n(h),m=s(116),p=s.n(m),g=s(134),y=s(135),f=s(136);class S extends n.Component{constructor(){super(...arguments),this.state={active:!1}}render(){const{disabled:e,handleOnClick:t,mutationFn:s,track:o}=this.props;return n.createElement(g.a,{onMouseOver:()=>this.setState({active:!0}),onMouseLeave:()=>this.setState({active:!1}),active:!e&&this.state.active,onClick:()=>{!e&&t&&t(o,s)},style:{display:"flex",cursor:e?"":"pointer"}},n.createElement("img",{style:{marginRight:"5px",maxHeight:"64px",paddingRight:"5px"},src:o.album.images[2].url}),n.createElement("div",null,n.createElement(y.a,null,o.name),n.createElement(f.a,null,o.artists.map(e=>e.name).join(", "))))}}var I=s(101),C=function(e,t,s,n){return new(s||(s=Promise))(function(o,a){function i(e){try{c(n.next(e))}catch(e){a(e)}}function r(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){e.done?o(e.value):new s(function(t){t(e.value)}).then(i,r)}c((n=n.apply(e,t||[])).next())})};class k extends n.Component{constructor(){super(...arguments),this.state={playlistTracks:[]}}componentDidMount(){const{playlistId:e,hostId:t}=this.props;this.getPlaylistTracks(e,t)}getPlaylistTracks(e,t){return C(this,void 0,void 0,function*(){const s=localStorage.getItem("tokenType"),n=localStorage.getItem("accessToken");if(e&&s&&n&&t){const o=yield I.a.getPlaylistTracks(s,n,t,e);if(o&&o.items){const e=[];o.items.map(t=>{e.push(t.track)}),this.setState({playlistTracks:e})}}})}render(){return n.createElement("div",{style:{height:"600px",overflow:"auto"}},n.createElement(u.a,{style:{marginBottom:0,marginTop:"5px"},color:"info"},"Songs Currently in Playlist (Not Suggested Songs)"),n.createElement(p.a,null,this.state.playlistTracks.map((e,t)=>n.createElement(S,{key:`${e.id+t}`,track:e,disabled:!0}))))}}var v=s(137),E=s(121),D=s(122),$=s(123),w=s(106),T=function(e,t,s,n){return new(s||(s=Promise))(function(o,a){function i(e){try{c(n.next(e))}catch(e){a(e)}}function r(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){e.done?o(e.value):new s(function(t){t(e.value)}).then(i,r)}c((n=n.apply(e,t||[])).next())})};class A extends n.Component{constructor(){super(...arguments),this.state={animated:"",mouseOnComponent:!1,searchQuery:"",searchResults:[],showDropdown:!1,timeoutId:0,typing:!1},this.handleOnClick=((e,t)=>T(this,void 0,void 0,function*(){const s=localStorage.getItem("graphSessionId");if(this.props.isJoiner){if(s&&e.id&&t)try{if((yield t({variables:{trackID:e.id,sessionGID:s}})).data.createTracks)return void o.NotificationManager.success(`"${e.name} by ${e.artists[0].name}"`,"Song was suggested to the playlist")}catch(t){return void o.NotificationManager.error(`"${e.name} by ${e.artists[0].name}"`,"Song was can not be suggested to the playlist")}o.NotificationManager.error(`"${e.name} by ${e.artists[0].name}"`,"Error in suggesting the song to the playlist")}else{const t=localStorage.getItem("tokenType"),s=localStorage.getItem("accessToken"),n=localStorage.getItem("createdPlaylistId");if(t&&s&&n)try{if(yield I.a.addTrackToPlaylist(t,s,n,e.uri))return o.NotificationManager.success(`"${e.name} by ${e.artists[0].name}"`,"Song was added to the playlist"),void this.props.reloadComponents()}catch(t){o.NotificationManager.error(`"${e.name} by ${e.artists[0].name}"`,"Song could not be added")}}})),this.handleClick=(e=>{this.node&&!this.node.contains(e.target)&&this.setState({showDropdown:!1})})}handleInputChange(e){this.state.timeoutId&&clearTimeout(this.state.timeoutId),this.setState({searchQuery:e.currentTarget.value,timeoutId:setTimeout(()=>T(this,void 0,void 0,function*(){const e=localStorage.getItem("tokenType"),t=localStorage.getItem("accessToken");if(e&&t){const s=yield I.a.searchTrack(e,t,this.state.searchQuery);s&&this.setState({searchResults:s.tracks.items})}this.setState({showDropdown:!0})}),700),typing:!1})}displaySearch(){return this.state.showDropdown?n.createElement(v.a,{style:{boxShadow:"5px 10px #888888"}},this.state.searchResults.map((e,t)=>n.createElement(w.a,null,s=>n.createElement(S,{key:`${e.id+t}`,track:e,disabled:!1,mutationFn:s,handleOnClick:this.handleOnClick})))):null}componentWillMount(){document.addEventListener("mousedown",this.handleClick,!1)}componentWillUnMount(){document.removeEventListener("mousedown",this.handleClick,!1)}render(){const e=this.state.showDropdown?100:-1;return n.createElement("div",{ref:e=>this.node=e},n.createElement(E.a,null,n.createElement(D.a,{style:{margin:"auto",padding:"30px 0 0 0",width:"90%"}},n.createElement($.a,{name:"song",id:"songSearch",placeholder:"Search",value:this.state.searchQuery,onChange:e=>this.handleInputChange(e),onClick:()=>{""!==this.state.searchQuery&&this.setState({showDropdown:!0})}}),n.createElement("div",{style:{border:"10px",height:"380px",margin:"auto",overflow:"auto",position:"absolute",webkitBoxShadow:"0 8px 6px 0px grey",width:"81%",zIndex:e}},this.displaySearch()))))}}var x=({ownerId:e,playlistId:t})=>n.createElement("iframe",{id:"player",src:`https://open.spotify.com/embed?uri=spotify:user:${e}:playlist:${t}&amp;view=coverart`,width:"100%",height:"380",allow:"encrypted-media",style:{marginTop:"30px"}}),b=function(e,t,s,n){return new(s||(s=Promise))(function(o,a){function i(e){try{c(n.next(e))}catch(e){a(e)}}function r(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){e.done?o(e.value):new s(function(t){t(e.value)}).then(i,r)}c((n=n.apply(e,t||[])).next())})};class _ extends n.Component{constructor(){super(...arguments),this.state={animated:"",suggestedTracks:[]},this.handleOnClick=((e,t)=>b(this,void 0,void 0,function*(){const s=localStorage.getItem("tokenType"),n=localStorage.getItem("accessToken"),a=localStorage.getItem("createdPlaylistId"),i=localStorage.getItem("graphSessionId");if(s&&n&&a)try{if((yield I.a.addTrackToPlaylist(s,n,a,e.uri))&&i&&e.gId&&t)try{if((yield t({variables:{trackId:e.gId,sessionId:i}})).data.removeFromSessionOnTracks){o.NotificationManager.success(`"${e.name} by ${e.artists[0].name}"`,"Suggested Song was added to the playlist");const t=this.state.suggestedTracks.filter(t=>t.gId!==e.gId);return this.setState({suggestedTracks:t}),void this.props.reloadComponent()}}catch(t){return o.NotificationManager.error(`"${e.name} by ${e.artists[0].name}"`,"Suggested Song was can not be added to the playlist"),void this.props.reloadComponent()}}catch(t){o.NotificationManager.error(`"${e.name} by ${e.artists[0].name}"`,"Song could not be added")}}))}componentDidMount(){const{tracks:e}=this.props;this.getSuggestions(e)}getSuggestions(e){return b(this,void 0,void 0,function*(){const t=localStorage.getItem("tokenType"),s=localStorage.getItem("accessToken");if(e&&t&&s&&e.length>0){const n=yield I.a.getTracks(t,s,e);n&&n.tracks&&this.setState({suggestedTracks:n.tracks.map(t=>{const s=e.find(e=>e.trackID===t.id);return Object.assign({},t,{gId:s?s.id:""})})})}return[]})}render(){return n.createElement("div",{style:{height:"380px",overflow:"auto"}},n.createElement(p.a,null,this.state.suggestedTracks.length<1?n.createElement("h3",{style:{textAlign:"center"}},"No Suggestions"):null,this.state.suggestedTracks.map((e,t)=>n.createElement(w.b,null,s=>n.createElement(S,{key:`${e.id+t}`,track:e,disabled:!1,mutationFn:s,handleOnClick:this.handleOnClick})))))}}var P=function(e,t,s,n){return new(s||(s=Promise))(function(o,a){function i(e){try{c(n.next(e))}catch(e){a(e)}}function r(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){e.done?o(e.value):new s(function(t){t(e.value)}).then(i,r)}c((n=n.apply(e,t||[])).next())})};class j extends n.Component{constructor(){super(...arguments),this.state={hasReloadingNotification:!1,name:"",refreshCounter:0,roomCode:"",roomData:void 0},this.refreshIframePlaylist=(()=>{if(this.state.hasReloadingNotification)return;this.setState({hasReloadingNotification:!0});o.NotificationManager.info("Spotify Playlist will autoreload in 30 seconds because of a delay in the Spotify API","Reloading...",3e4),setTimeout(()=>{this.setState({hasReloadingNotification:!1,refreshCounter:this.state.refreshCounter+1})},3e4)})}componentDidMount(){return P(this,void 0,void 0,function*(){if(this.props.code)this.setState({roomCode:this.props.code});else{const e=localStorage.getItem("graphSessionShortCode");e&&this.setState({roomCode:e})}const e=localStorage.getItem("tokenType"),t=localStorage.getItem("accessToken");if(this.props.session.Session&&e&&t){const s=this.props.session.Session.sessionID,n=this.props.session.Session.hostID,o=yield I.a.getPlaylist(e,t,n,s);o&&this.setState({roomData:o})}})}displaySuggestions(){return P(this,void 0,void 0,function*(){return n.createElement("div",null)})}render(){const e=!!this.props.code;return this.state.roomData?n.createElement("div",null,n.createElement(r.a,{style:{margin:"0px"}},n.createElement(c.a,{style:N.jumbotron},n.createElement("div",{style:{margin:"auto",width:"90%",paddingBottom:"5px"}},n.createElement("h1",{style:{fontSize:"60px",marginBottom:"0px",textAlign:"left"}},n.createElement("b",null,this.state.roomData.name)),n.createElement("p",{style:{color:"white",fontSize:"13px",margin:"0px",textAlign:"left"}},this.state.roomData.description),n.createElement("p",{style:{color:"white"}},"Hosted by ",this.state.roomData.owner.display_name),n.createElement("p",{style:{color:"white",marginBottom:0}},"Share Code: ",n.createElement("b",null,this.state.roomCode))))),e?n.createElement(r.a,{style:{backgroundColor:"#d5d5d5",margin:"0"}},n.createElement(d.a,{sm:12,md:12,style:{padding:"0"}},n.createElement("div",{style:{margin:"auto",width:"90%"}},n.createElement("div",null,n.createElement(A,{isJoiner:e,reloadComponents:this.refreshIframePlaylist})),n.createElement("div",{style:{width:"90%",margin:"auto"}},n.createElement(w.c,{variables:{shortCode:localStorage.getItem("graphSessionShortCode")||this.props.code||""},pollInterval:1e4},({loading:t,error:s,data:o})=>{if(s)return`Error! ${s.message}`;if(t||!o)return n.createElement(l.a,{height:150});if(o.Session){const t=o.Session.sessionID,s=o.Session.hostID;if(t&&s&&o.Session.trackses)return n.createElement(k,{key:o.Session.trackses.length,isJoiner:e,playlistId:t,hostId:s})}return n.createElement("h2",null,"No Data.")}))))):n.createElement(r.a,{style:{backgroundColor:"#d5d5d5",margin:"0"}},n.createElement(d.a,{sm:12,md:6,style:{padding:"0"}},n.createElement("div",{style:{margin:"auto",width:"90%"}},n.createElement("div",null,n.createElement(A,{isJoiner:e,reloadComponents:this.refreshIframePlaylist})),n.createElement("div",{style:{width:"90%",margin:"auto"}},n.createElement(x,{key:this.state.refreshCounter,ownerId:this.state.roomData.owner.id,playlistId:this.state.roomData.id})))),n.createElement(d.a,{sm:12,md:6,style:{padding:"0"}},n.createElement("div",{style:{backgroundColor:"#c3c3c3",margin:" 15px auto",padding:"15px 0",textAlign:"center",width:"90%"}},"Suggestions"),n.createElement("div",{style:{width:"90%",margin:"auto"}},n.createElement(w.c,{variables:{shortCode:localStorage.getItem("graphSessionShortCode")||""},pollInterval:1e4},({loading:t,error:s,data:o})=>s?`Error! ${s.message}`:t||!o?"Loading...":o.Session&&o.Session.trackses?n.createElement(_,{key:o.Session.trackses.length,isJoiner:e,tracks:o.Session.trackses,reloadComponent:this.refreshIframePlaylist}):n.createElement(l.a,null)))))):n.createElement(l.a,null)}}const N={button:{width:"100%"},col:{paddingTop:"15px"},jumbotron:{backgroundColor:"rgb(45, 45, 45)",borderRadius:"0px",color:"#1db954",marginBottom:"0px",padding:"0px",paddingLeft:"20px",paddingRight:"20px",width:"100%"},page:{backgroundColor:"rgb(45, 45, 45)",color:"white"},row:{marginLeft:"0px",marginRight:"0px",paddingBottom:"15px",paddingTop:"15px"}};t.default=Object(i.a)(e=>n.createElement(w.c,{variables:{shortCode:e.match.params.code||localStorage.getItem("graphSessionShortCode")||""}},({loading:t,error:s,data:o})=>s?`Error! ${s.message}`:t||!o?"Loading...":o.Session?(localStorage.setItem("graphSessionId",o.Session.id),e.match.params.code?n.createElement(j,{code:e.match.params.code,session:o}):n.createElement(j,{session:o})):n.createElement(a.a,{to:"/"})))}}]);